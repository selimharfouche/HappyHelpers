TODO : FILTER ALSO ON MPAGE BY CAPITAL, ENTREPRISE SIZE ETC CHECK JSON


TODO: change JSON LIKE AFTER AI PROCESS COPY IT TO WEBSITE DIRECTORY  !
To use this system:

Run python create_configs.py --all to create the initial configuration files
Run python main.py to process all configured sites
Or run python main.py --sites lockbit bashe to process specific sites


tor config :
a12@1 721 % cat  ~/.tor/torrc

SocksPort 9050
ControlPort 9051
CookieAuthentication 1
# Longer circuit timeout for onion services
CircuitBuildTimeout 60
# More aggressive circuit handling
LearnCircuitBuildTimeout 0
# Improve onion service performance
HiddenServiceStatistics 0
OptimisticData 1
a12@1 721 % tor -f ~/.tor/torrc

# Ransomware Tracker

A comprehensive system for monitoring and analyzing ransomware leak sites through Tor. This project automatically tracks multiple ransomware groups, detects new victims, standardizes data formats, and provides real-time notifications.

## Table of Contents

1. [Project Overview](#project-overview)
2. [System Architecture](#system-architecture)
3. [Installation](#installation)
4. [Configuration](#configuration)
5. [Usage](#usage)
6. [Telegram Notifications](#telegram-notifications)
7. [AI Data Enrichment](#ai-data-enrichment)
8. [Directory Structure](#directory-structure)

## Project Overview

The Ransomware Tracker automatically monitors various ransomware leak sites through Tor, identifying and tracking entities (victims) that have been targeted by ransomware groups. Key features include:

- **Multi-site monitoring**: Tracks multiple ransomware groups (LockBit, Bashe, RansomHub, etc.)
- **Configuration-based architecture**: Add new ransomware sites without code changes
- **Entity tracking**: Identifies new victims and tracks their status over time
- **Real-time notifications**: Sends alerts via Telegram when new victims are discovered
- **Data standardization**: Converts different date formats and fields to a consistent structure
- **AI enrichment**: Enhances victim data with organizational information using AI
- **GitHub Actions integration**: Runs automatically on schedule in the cloud

The system is designed for cybersecurity researchers, threat intelligence analysts, and organizations that need to monitor ransomware activity across the threat landscape.

## System Architecture

The system uses a modular, configuration-based architecture:

1. **Scraper Module**: Connects to ransomware sites via Tor and extracts HTML content
2. **Parser Module**: Uses site-specific configurations to extract entity information
3. **Processing Pipeline**: Standardizes and archives entity data
4. **Notification System**: Sends real-time alerts via Telegram
5. **AI Enrichment**: Enhances entity data with additional organizational information

Data flows through the system as follows:
- Raw HTML ‚Üí Structured JSON ‚Üí Standardized formats ‚Üí AI enrichment ‚Üí Notifications

The configuration-based approach allows adding new ransomware sites by simply creating a JSON configuration file, without modifying any code.

## Installation

### Prerequisites

- Python 3.9+
- Tor service
- Firefox (for Selenium)
- Geckodriver (for Selenium)

### Setup

1. Clone the repository:
   ```bash
   git clone https://github.com/yourusername/ransomware-tracker.git
   cd ransomware-tracker
   ```

2. Create and activate a virtual environment:
   ```bash
   # Create virtual environment
   python -m venv venv
   
   # Activate on Windows
   venv\Scripts\activate
   
   # Activate on macOS/Linux
   source venv/bin/activate
   ```

3. Install dependencies:
   ```bash
   pip install -r requirements.txt
   ```

4. Create a `.env` file in the project root with your Telegram credentials (if using notifications):
   ```
   TELEGRAM_BOT_TOKEN=your_bot_token_here
   TELEGRAM_CHANNEL_ID=your_channel_id_here
   ```

5. For AI enrichment, add your OpenAI API key to the `.env` file:
   ```
   OPENAI_API_KEY=your_openai_api_key_here
   ```

## Configuration

The system uses JSON configuration files to control various aspects of operation.

### Site Configurations

Site configurations are stored in `config/sites/` with one file per ransomware group. Example:

```json
{
  "site_key": "lockbit",
  "site_name": "LockBit",
  "json_file": "lockbit_entities.json",
  "mirrors": [
    "lockbit3753ekiocyo5epmpy6klmejchjtzddoekjlnt6mu3qh4de2id.onion",
    "lockbit3g3ohd3katajf6zaehxz4h4cnhmz5t735zpltywhwpc6oy3id.onion"
  ],
  "site_verification": {
    "type": "text",
    "value": "LockBit"
  },
  "parsing": {
    "entity_selector": "a.post-block",
    "fields": [
      {
        "name": "id",
        "type": "attribute",
        "selector": "self",
        "attribute": "href",
        "regex": "^\\/?(.+)$",
        "regex_group": 1
      },
      // Additional field configurations...
    ]
  }
}
```

### Browser Configuration

Browser settings are controlled in `config/code/browser_config.json`:

```json
{
  "timing": {
    "min_wait_time": 10,
    "max_wait_time": 20,
    "tor_check_wait_time": 3,
    "page_load_timeout": 120
  },
  "anti_bot": {
    "enabled": true,
    "randomize_timing": true
  },
  "user_agent": "Mozilla/5.0 (Windows NT 10.0; rv:102.0) Gecko/20100101 Firefox/102.0"
}
```

### Proxy Configuration

Tor and proxy settings are configured in `config/code/proxy_config.json`:

```json
{
  "proxy": {
    "type": "socks",
    "host": "127.0.0.1",
    "port": 9050,
    "remote_dns": true
  },
  "tor": {
    "auto_start": true,
    "config": [
      "SocksPort 9050",
      "ControlPort 9051",
      "CookieAuthentication 1",
      "CircuitBuildTimeout 60"
    ]
  }
}
```

### Scraping Configuration

Scraping behavior is controlled in `config/code/scraping_config.json`:

```json
{
  "snapshots": {
    "save_html": false,
    "max_snapshots_per_site": 5,
    "cleanup_old_snapshots": true
  },
  "scheduling": {
    "frequency_hours": 6,
    "randomize_start_time": true
  }
}
```

## Usage

### Basic Usage

Run the main script to scrape all configured sites:

```bash
cd tracker
python main.py
```

### Command Line Options

```bash
# Scrape specific sites
python main.py --sites lockbit bashe

# Run in headless mode (no visible browser)
python main.py --headless

# Skip entity processing after scraping
python main.py --no-process
```

### Creating New Site Configurations

To track a new ransomware group, create a configuration file:

```bash
python create_configs.py --sites new_ransomware_group
```

Then edit the generated file in `config/sites/` to match the site's structure.

### GitHub Actions Integration

The project includes a GitHub Actions workflow (`scrape.yml`) that runs the scraper automatically on a schedule. To use it:

1. Fork the repository
2. Add your Telegram credentials as GitHub secrets:
   - `TELEGRAM_BOT_TOKEN`
   - `TELEGRAM_CHANNEL_ID`
3. Enable GitHub Actions in your repository

The workflow runs every 6 hours by default, but you can modify the schedule in the workflow file.

## Telegram Notifications

The system can send real-time notifications about new ransomware victims via Telegram.

### Setting Up Telegram Bot

1. Create a Telegram bot using [@BotFather](https://t.me/botfather)
2. Create a Telegram channel or group
3. Add your bot to the channel/group as an admin
4. Get the channel ID (can be in format `-100xxxxxxxxxx`)
5. Add these credentials to your `.env` file or GitHub secrets

### Types of Notifications

The system sends two types of notifications:

1. **Entity Notifications**: Sent when a new ransomware victim is discovered
2. **Scan Completion Notifications**: Sent at the end of each scan with a summary

Example entity notification:
```
üö® New Ransomware Victim Discovered!

Domain: example.com
Ransomware Group: LockBit
Status: ‚è≥ Countdown
Views: 156

Description:
Example Corp data breach including financial records and customer information...

Countdown: 5d 4h 32m 15s
Estimated Publication: 2023-09-15 12:30:00 UTC

First seen: 2023-09-10 08:15:22 UTC
```

### Notification Logs

All notifications are logged to `logs/telegram_notifications.log` for history tracking.

## AI Data Enrichment

The system can enrich entity data with organizational information using the OpenAI API.

### Setup

1. Add your OpenAI API key to the `.env` file
2. Run the extraction script to prepare data:
   ```bash
   cd AI
   python extract_ai_fields.py
   ```
3. Run the enrichment process:
   ```bash
   python domain_enrichment.py
   ```

### Batch Processing

The enrichment process works in batches of 100 domains by default. You can:
- Preview batches before processing (`python domain_enrichment.py`)
- Automatically process all batches (`python domain_enrichment.py --yes`)
- Hide preview details (`python domain_enrichment.py --no-preview`)

### Output Data

The AI enrichment adds the following information to each entity:

```json
{
  "domain": "example.com",
  "geography": {
    "country_code": "USA",
    "region": "California",
    "city": "San Francisco"
  },
  "organization": {
    "name": "Example Corporation",
    "industry": "Technology",
    "sub_industry": "Software Development",
    "size": {
      "employees_range": "100-499",
      "revenue_range": "$10M-$50M"
    },
    "status": "Private"
  }
}
```

The enriched data is saved to `AI/processed_AI.json`.

## Directory Structure

```
project-root/
‚îú‚îÄ‚îÄ tracker/                    # Python code
‚îÇ   ‚îú‚îÄ‚îÄ main.py                 # Main script
‚îÇ   ‚îú‚îÄ‚îÄ create_configs.py       # Script to create site configs
‚îÇ   ‚îú‚îÄ‚îÄ browser/                # Browser modules
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ tor_browser.py      # Tor browser management
‚îÇ   ‚îú‚îÄ‚îÄ config/                 # Configuration handling
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ config_handler.py   # Configuration loader
‚îÇ   ‚îú‚îÄ‚îÄ scraper/                # Scraper modules
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ base_parser.py      # Base parser class
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ generic_parser.py   # Generic site parser
‚îÇ   ‚îú‚îÄ‚îÄ processing/             # Data processing scripts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ entity_merger.py    # Combines entities from all sites
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ process_entities.py # Standardizes and archives entities
‚îÇ   ‚îî‚îÄ‚îÄ telegram_bot/           # Telegram notification system
‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îî‚îÄ‚îÄ notifier.py         # Notification sender
‚îú‚îÄ‚îÄ config/                     # Configuration files
‚îÇ   ‚îú‚îÄ‚îÄ sites/                  # Site configurations
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ lockbit.json        # LockBit configuration
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ bashe.json          # Bashe configuration
‚îÇ   ‚îî‚îÄ‚îÄ code/                   # Code-related configurations
‚îÇ       ‚îú‚îÄ‚îÄ browser_config.json # Browser settings
‚îÇ       ‚îú‚îÄ‚îÄ proxy_config.json   # Proxy and Tor settings
‚îÇ       ‚îî‚îÄ‚îÄ scraping_config.json # Scraping behavior settings
‚îú‚îÄ‚îÄ data/                       # Data storage
‚îÇ   ‚îú‚îÄ‚îÄ output/                 # Raw JSON output
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ lockbit_entities.json
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ bashe_entities.json
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ new_entities.json   # Newly discovered entities
‚îÇ   ‚îú‚îÄ‚îÄ processed/              # Processed data
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ all_entities.json   # All entities merged
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ final_entities.json # Standardized archive
‚îÇ   ‚îú‚îÄ‚îÄ new_entities_snapshot/  # Historical snapshots
‚îÇ   ‚îî‚îÄ‚îÄ html_snapshots/         # Raw HTML snapshots
‚îú‚îÄ‚îÄ AI/                         # AI enrichment system
‚îÇ   ‚îú‚îÄ‚îÄ extract_ai_fields.py    # Extracts fields for AI processing
‚îÇ   ‚îú‚îÄ‚îÄ domain_enrichment.py    # Enriches domains with OpenAI
‚îÇ   ‚îú‚îÄ‚îÄ AI.json                 # Extracted basic entity data
‚îÇ   ‚îú‚îÄ‚îÄ processed_AI.json       # Enriched entity data
‚îÇ   ‚îú‚îÄ‚îÄ raw_responses/          # Raw API responses
‚îÇ   ‚îî‚îÄ‚îÄ batch_previews/         # Preview of batch requests
‚îú‚îÄ‚îÄ logs/                       # Log files
‚îÇ   ‚îî‚îÄ‚îÄ telegram_notifications.log # Notification history
‚îú‚îÄ‚îÄ .github/                    # GitHub configuration
‚îÇ   ‚îî‚îÄ‚îÄ workflows/
‚îÇ       ‚îî‚îÄ‚îÄ scrape.yml          # GitHub Actions workflow
‚îú‚îÄ‚îÄ requirements.txt            # Python dependencies
‚îî‚îÄ‚îÄ README.md                   # This file
```

This README provides an overview of the project's functionality and usage. For more detailed information about specific components, refer to the documentation in the corresponding directories.